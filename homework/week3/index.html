<!--
-	Course: Data Processing 
-	Name: Marwa Ahmed 
-	Student number: 10747141
-	Create a bar chart in D3
-->

<!--
	Used Sources: http://www.tutorialsteacher.com/d3js/loading-data-from-file-in-d3js
-->

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<script type="text/javascript" src="d3/d3.v3.js"></script>
		<script type="text/javascript" src="d3/d3.tip.v0.6.3.js"></script>
		<script type="text/javascript">
			d3.select("head").append("title").text("Creating an interactive bar chart using D3");
		</script>
	</head>
	<body>
		<script type="text/javascript">
			d3.select("body").append("h3").text("Name: Marwa Ahmed, Student number: 10747141");
			d3.select("body").append("p").text("This bar chart visualizes the number of students for each province in the Netherlands.");

			// binding data
			d3.json("datasets.json", function(error, dataset){
				if(error) {
					return console.warn(error);
				}

				// variables for width and height etc.
				var svgWidth = 700;
				var svgHeight = 400;
				var barPadding = 1;
				var margin = {left: 50, right: 50, top: 50, bottom: 50};
				var horizontalRange = svgWidth - margin.right;
				var verticalRange = svgHeight - margin.top;
				var widthBar = (horizontalRange-margin.left)/dataset.data.length;


				// push data for x-axis in array
				var provinces = [];
				for (var i = 0; i < dataset.data.length; i++){
					provinces.push(dataset.data.province);
				}

				// scale-function for the x-axis
				var xScale = d3.scale.ordinal()
					 .domain([0, dataset.data.length])
					 .range([margin.left, horizontalRange]);

				// min and max value from data (y-axis)
				var minData = d3.min(dataset.data, function(d){return d.NoStudents; })
				var maxData = d3.max(dataset.data, function(d){return d.NoStudents; })

				// scale-function for y-axis
				var yScale = d3.scale.linear()
									.domain([0, maxData])
									.range([margin.top, verticalRange - margin.bottom]);

				// create svg element
				var svg = d3.select("body")
							.append("svg")
							.attr("class", "bar")
							.attr("width", svgWidth)
							.attr("height", svgHeight);

				// draw the rectangles from the data
				var rectangles = svg.selectAll("rect")
							.data(dataset.data)
							.enter()
							.append("rect")
							
							.attr("x", function(d, i){
								// push each subsequent bar to the right
								return (i * xScale(widthBar)) + margin.left;
							})
							
							// top bar = height minus data value
							.attr("y", function(d){
								return verticalRange - yScale(d.NoStudents);
							})
							
							// dynamic bar width
							.attr("width", widthBar - barPadding)
							
							// encode data as the height of each bar
							.attr("height", function(d){
								return yScale(d.NoStudents);
							})

							// color the bar chart
							.attr("fill", "teal");

							// show actual data values by adding labels
							svg.selectAll("text")
								.data(dataset.data)
								.enter()
								.append("text")
								.text(function(d){
									return d.NoStudents;
								})

								// center the text horizontally at the assigned x value
								.attr("text-anchor", "middle")

								// set x position of text to the left edge of each bar plus half the bar width
								.attr("x", function(d, i){
									return i * xScale(widthBar) + (xScale(widthBar) - barPadding)/ 2 + margin.left;
								})

								// y position of text value
								.attr("y", function(d){
									return verticalRange - yScale(d.NoStudents);
								})
								.attr("font-family", "sans-serif")
								.attr("font-size", "11px")
								.attr("fill", "black");

					// Axis
					//var xAxis = d3.svg.axis()
			});

		</script>



<!-- 		<svg width="500" height="100">
			<rect x="0" y="0" width="50" height="750" fill="purple" stroke="pink" stroke-width="5"/>
			<line x1="0" y1="100" x2="500" y2="100" stroke="black"/>
			<text x="250" y="15">Title</text>
		</svg> -->



		<div class="bar"></div>
	</body>
</html>







